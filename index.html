<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>HEARTMAN: Hug Edition</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Press+Start+2P&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
Â  Â  <style>
Â  Â  Â  Â  * { margin: 0; padding: 0; box-sizing: border-box; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --primary: #ff1493;
Â  Â  Â  Â  Â  Â  --secondary: #00d4ff;
Â  Â  Â  Â  Â  Â  --accent: #ff006e;
Â  Â  Â  Â  Â  Â  --dark-bg: #0a0e27;
Â  Â  Â  Â  Â  Â  --darker-bg: #050810;
Â  Â  Â  Â  Â  Â  --neon-pink: #ff007f;
Â  Â  Â  Â  Â  Â  --neon-cyan: #00ffff;
Â  Â  Â  Â  Â  Â  --neon-purple: #b300ff;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, var(--dark-bg) 0%, #1a0033 50%, var(--darker-bg) 100%);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  touch-action: none;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  Â  Â  -webkit-user-select: none;
Â  Â  Â  Â  Â  Â  font-family: 'Fredoka One', sans-serif;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  min-height: 100dvh;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #game-container {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  width: 100vw;
Â  Â  Â  Â  Â  Â  height: 100dvh;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  background: radial-gradient(ellipse at 50% 50%, rgba(255, 20, 147, 0.1) 0%, transparent 70%);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  canvas {
Â  Â  Â  Â  Â  Â  box-shadow:Â 
Â  Â  Â  Â  Â  Â  Â  Â  0 0 30px rgba(255, 0, 127, 0.4),
Â  Â  Â  Â  Â  Â  Â  Â  0 0 60px rgba(0, 212, 255, 0.2),
Â  Â  Â  Â  Â  Â  Â  Â  inset 0 0 30px rgba(255, 0, 127, 0.1);
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  border: 2px solid var(--neon-pink);
Â  Â  Â  Â  Â  Â  max-width: 100%;
Â  Â  Â  Â  Â  Â  max-height: 85vh;
Â  Â  Â  Â  Â  Â  background: #000;
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .ui-layer {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 560px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  Â  Â  font-family: 'Press Start 2P', monospace;
Â  Â  Â  Â  Â  Â  font-size: 11px;
Â  Â  Â  Â  Â  Â  letter-spacing: 2px;
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-cyan);
Â  Â  Â  Â  Â  Â  background: rgba(10, 14, 39, 0.6);
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin-top: 8px;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 0, 127, 0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .ui-layer > div {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .score-label {
Â  Â  Â  Â  Â  Â  color: var(--neon-pink);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 10px var(--neon-pink);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #score-el {
Â  Â  Â  Â  Â  Â  color: var(--neon-cyan);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 10px var(--neon-cyan);
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  min-width: 60px;
Â  Â  Â  Â  Â  Â  text-align: right;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .goal-label {
Â  Â  Â  Â  Â  Â  color: var(--neon-purple);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 10px var(--neon-purple);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .neon-text {
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 5px currentColor, 0 0 10px currentColor;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .hidden {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .fade-in {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Start Screen */
Â  Â  Â  Â  #start-screen {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  inset: 0;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, rgba(10, 14, 39, 0.95) 0%, rgba(26, 0, 51, 0.95) 100%);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  z-index: 50;
Â  Â  Â  Â  Â  Â  transition: opacity 0.5s ease, visibility 0.5s ease;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 0, 127, 0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-screen.hidden {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  visibility: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .title-container {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  animation: titleGlow 2s ease-in-out infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes titleGlow {
Â  Â  Â  Â  Â  Â  0%, 100% { text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink); }
Â  Â  Â  Â  Â  Â  50% { text-shadow: 0 0 20px var(--neon-pink), 0 0 40px var(--neon-cyan), 0 0 60px var(--neon-pink); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .title-main {
Â  Â  Â  Â  Â  Â  font-family: 'Orbitron', sans-serif;
Â  Â  Â  Â  Â  Â  font-size: clamp(3rem, 10vw, 5rem);
Â  Â  Â  Â  Â  Â  font-weight: 900;
Â  Â  Â  Â  Â  Â  color: var(--neon-pink);
Â  Â  Â  Â  Â  Â  letter-spacing: 4px;
Â  Â  Â  Â  Â  Â  line-height: 1.1;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .title-sub {
Â  Â  Â  Â  Â  Â  font-family: 'Fredoka One', sans-serif;
Â  Â  Â  Â  Â  Â  font-size: clamp(0.8rem, 3vw, 1.2rem);
Â  Â  Â  Â  Â  Â  color: var(--neon-cyan);
Â  Â  Â  Â  Â  Â  letter-spacing: 3px;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  margin-bottom: 32px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-btn {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  padding: 16px 32px;
Â  Â  Â  Â  Â  Â  background: transparent;
Â  Â  Â  Â  Â  Â  border: 3px solid var(--neon-pink);
Â  Â  Â  Â  Â  Â  color: var(--neon-pink);
Â  Â  Â  Â  Â  Â  font-family: 'Press Start 2P', monospace;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  letter-spacing: 2px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 20px rgba(255, 0, 127, 0.3);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  margin-bottom: 32px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-btn::before {
Â  Â  Â  Â  Â  Â  content: '';
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: -100%;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background: var(--neon-pink);
Â  Â  Â  Â  Â  Â  transition: left 0.3s ease;
Â  Â  Â  Â  Â  Â  z-index: -1;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-btn:hover::before {
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-btn:hover {
Â  Â  Â  Â  Â  Â  color: #000;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 30px rgba(255, 0, 127, 0.6), 0 0 60px rgba(0, 212, 255, 0.3);
Â  Â  Â  Â  Â  Â  transform: scale(1.05);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #start-btn:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.98);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .instructions {
Â  Â  Â  Â  Â  Â  margin-top: 24px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-family: 'Press Start 2P', monospace;
Â  Â  Â  Â  Â  Â  font-size: 10px;
Â  Â  Â  Â  Â  Â  letter-spacing: 1px;
Â  Â  Â  Â  Â  Â  color: var(--neon-cyan);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 10px var(--neon-cyan);
Â  Â  Â  Â  Â  Â  line-height: 1.8;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .instruction-item {
Â  Â  Â  Â  Â  Â  margin: 8px 0;
Â  Â  Â  Â  Â  Â  animation: pulse 2s ease-in-out infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .instruction-item:nth-child(2) {
Â  Â  Â  Â  Â  Â  animation-delay: 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes pulse {
Â  Â  Â  Â  Â  Â  0%, 100% { opacity: 0.6; }
Â  Â  Â  Â  Â  Â  50% { opacity: 1; }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Finale Screen */
Â  Â  Â  Â  #finale-screen {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  inset: 0;
Â  Â  Â  Â  Â  Â  background: radial-gradient(circle at 50% 50%, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.95) 100%);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  z-index: 60;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  Â  Â  transition: opacity 1s ease;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(8px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #finale-screen.active {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .heart-container {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  Â  Â  height: 200px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 40px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .heart-emoji {
Â  Â  Â  Â  Â  Â  font-size: clamp(4rem, 15vw, 8rem);
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  transition: all 1s ease;
Â  Â  Â  Â  Â  Â  filter: drop-shadow(0 0 20px rgba(255, 0, 127, 0.5));
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #final-heart {
Â  Â  Â  Â  Â  Â  left: 15%;
Â  Â  Â  Â  Â  Â  animation: heartFloat 3s ease-in-out infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #final-partner {
Â  Â  Â  Â  Â  Â  right: 15%;
Â  Â  Â  Â  Â  Â  opacity: 0.4;
Â  Â  Â  Â  Â  Â  animation: partnerFloat 3s ease-in-out infinite;
Â  Â  Â  Â  Â  Â  animation-delay: 0.5s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #final-hug {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: scale(0.5);
Â  Â  Â  Â  Â  Â  animation: hugAppear 1s ease-out forwards 1.5s, hugPulse 1s ease-in-out infinite 2.5s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes heartFloat {
Â  Â  Â  Â  Â  Â  0%, 100% { transform: translateY(0px); }
Â  Â  Â  Â  Â  Â  50% { transform: translateY(-20px); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes partnerFloat {
Â  Â  Â  Â  Â  Â  0%, 100% { transform: translateY(0px); }
Â  Â  Â  Â  Â  Â  50% { transform: translateY(-20px); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes hugAppear {
Â  Â  Â  Â  Â  Â  to { opacity: 1; transform: scale(1); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes hugPulse {
Â  Â  Â  Â  Â  Â  0%, 100% { transform: scale(1); }
Â  Â  Â  Â  Â  Â  50% { transform: scale(1.1); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .finale-text {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 1s ease;
Â  Â  Â  Â  Â  Â  animation: fadeInText 1s ease-out forwards 2.5s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes fadeInText {
Â  Â  Â  Â  Â  Â  to { opacity: 1; }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .finale-quote {
Â  Â  Â  Â  Â  Â  font-family: 'Fredoka One', sans-serif;
Â  Â  Â  Â  Â  Â  font-size: clamp(1rem, 4vw, 1.4rem);
Â  Â  Â  Â  Â  Â  color: var(--neon-cyan);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 20px var(--neon-cyan);
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  Â  Â  margin-bottom: 24px;
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  Â  Â  max-width: 90%;
Â  Â  Â  Â  Â  Â  margin-left: auto;
Â  Â  Â  Â  Â  Â  margin-right: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .finale-title {
Â  Â  Â  Â  Â  Â  font-family: 'Press Start 2P', monospace;
Â  Â  Â  Â  Â  Â  font-size: clamp(0.8rem, 3vw, 1.2rem);
Â  Â  Â  Â  Â  Â  color: var(--neon-pink);
Â  Â  Â  Â  Â  Â  text-shadow: 0 0 20px var(--neon-pink);
Â  Â  Â  Â  Â  Â  letter-spacing: 2px;
Â  Â  Â  Â  Â  Â  margin-bottom: 24px;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .finale-btn {
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  border: 2px solid var(--neon-pink);
Â  Â  Â  Â  Â  Â  background: transparent;
Â  Â  Â  Â  Â  Â  color: var(--neon-pink);
Â  Â  Â  Â  Â  Â  font-family: 'Press Start 2P', monospace;
Â  Â  Â  Â  Â  Â  font-size: 10px;
Â  Â  Â  Â  Â  Â  letter-spacing: 1px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 15px rgba(255, 0, 127, 0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .finale-btn:hover {
Â  Â  Â  Â  Â  Â  background: var(--neon-pink);
Â  Â  Â  Â  Â  Â  color: #000;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 30px rgba(255, 0, 127, 0.6);
Â  Â  Â  Â  Â  Â  transform: scale(1.05);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Responsive */
Â  Â  Â  Â  @media (max-width: 600px) {
Â  Â  Â  Â  Â  Â  .ui-layer {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 9px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 10px 16px;
Â  Â  Â  Â  Â  Â  Â  Â  gap: 12px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  canvas {
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  Â  Â  border-width: 1px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<div id="game-container">
Â  Â  <div class="ui-layer">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <span class="score-label">SCORE:</span>
Â  Â  Â  Â  Â  Â  <span id="score-el">0</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <span class="goal-label">GOAL: 274</span>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <canvas id="gameCanvas"></canvas>

Â  Â  <div id="start-screen">
Â  Â  Â  Â  <div class="title-container">
Â  Â  Â  Â  Â  Â  <div class="title-main">HEART<br>MAN</div>
Â  Â  Â  Â  Â  Â  <div class="title-sub">â¤ï¸ HUG DAY SPECIAL â¤ï¸</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="enemies-display" style="margin: 20px 0; text-align: center; font-family: 'Press Start 2P', monospace; font-size: 9px; color: #00d4ff; text-shadow: 0 0 10px #00d4ff;"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button id="start-btn">INSERT COIN</button>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="instructions">
Â  Â  Â  Â  Â  Â  <div class="instruction-item">â¤ï¸ = LOVE (COLLECT)</div>
Â  Â  Â  Â  Â  Â  <div class="instruction-item">ğŸ® SWIPE TO MOVE</div>
Â  Â  Â  Â  Â  Â  <div class="instruction-item">ğŸ‘» AVOID GLOOMS</div>
Â  Â  Â  Â  Â  Â  <div class="instruction-item">ğŸ’— POWERUPS UNLOCK QUOTES</div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="finale-screen">
Â  Â  Â  Â  <div class="heart-container">
Â  Â  Â  Â  Â  Â  <div id="final-heart" class="heart-emoji">â¤ï¸</div>
Â  Â  Â  Â  Â  Â  <div id="final-partner" class="heart-emoji">ğŸ‘¤</div>
Â  Â  Â  Â  Â  Â  <div id="final-hug" class="heart-emoji">ğŸ«‚</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="finale-text">
Â  Â  Â  Â  Â  Â  <p class="finale-quote">
Â  Â  Â  Â  Â  Â  Â  Â  "No matter how difficult things can get,<br>I would do anything for that hug."
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <h2 class="finale-title">HAPPY HUG DAY!</h2>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <button class="finale-btn" onclick="location.reload()">REPLAY FOREVER</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
Â  Â  // ============================================
Â  Â  // HEARTMAN: HUG EDITION - COMPLETE GAME
Â  Â  // ============================================
Â  Â Â 
Â  Â  const canvas = document.getElementById('gameCanvas');
Â  Â  const ctx = canvas.getContext('2d');
Â  Â  const scoreEl = document.getElementById('score-el');
Â  Â  const startScreen = document.getElementById('start-screen');
Â  Â  const finaleScreen = document.getElementById('finale-screen');

Â  Â  // --- CONFIGURATION ---
Â  Â  const width = 28;
Â  Â  const TILE_SIZE = 20;
Â  Â  const layout = [
Â  Â  Â  Â  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,3,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,3,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,4,4,4,4,4,4,4,4,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,1,1,1,2,2,1,1,1,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,1,2,2,2,2,2,2,1,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  4,4,4,4,4,4,0,0,0,4,1,2,2,2,2,2,2,1,4,0,0,0,4,4,4,4,4,4,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,1,2,2,2,2,2,2,1,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,1,1,1,1,1,1,1,1,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,1,1,1,1,1,0,1,1,4,1,1,1,1,1,1,1,1,4,1,1,0,1,1,1,1,1,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0,1,
Â  Â  Â  Â  1,3,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,3,1,
Â  Â  Â  Â  1,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,
Â  Â  Â  Â  1,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,
Â  Â  Â  Â  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
Â  Â  Â  Â  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
Â  Â  ];

Â  Â  let squares = [];
Â  Â  let score = 0;
Â  Â  let gameActive = false;
Â  Â  let musicStarted = false;
Â  Â  let audioContext = null;
Â  Â  let oscillators = [];
Â  Â Â 
Â  Â  let pacman = { index: 490, dir: 1, nextDir: 1, rot: 0 };
Â  Â  let animationId;
Â  Â Â 
Â  Â  // Hug-themed powerup quotes
Â  Â  const hugQuotes = [
Â  Â  Â  Â  "A hug is the best medicine for a broken heart.",
Â  Â  Â  Â  "In your arms, I find my home.",
Â  Â  Â  Â  "Every hug is a promise of forever.",
Â  Â  Â  Â  "Your hug makes everything better.",
Â  Â  Â  Â  "I love you more than words can say.",
Â  Â  Â  Â  "Hugs are proof that love is real.",
Â  Â  Â  Â  "You're my favorite person to hug.",
Â  Â  Â  Â  "A hug from you is worth a thousand words.",
Â  Â  Â  Â  "Together, we're unstoppable.",
Â  Â  Â  Â  "You make my heart skip a beat."
Â  Â  ];
Â  Â Â 
Â  Â  let ghosts = [
Â  Â  Â  Â  { name: 'blinky', index: 348, speed: 150, timer: 0, scared: false, start: 348, currentDir: -1, color: '#ff1744', displayName: 'STRESS' },
Â  Â  Â  Â  { name: 'pinky', index: 376, speed: 200, timer: 0, scared: false, start: 376, currentDir: -1, color: '#ff6ec7', displayName: 'ANXIETY' },
Â  Â  Â  Â  { name: 'inky', index: 351, speed: 250, timer: 0, scared: false, start: 351, currentDir: 1, color: '#9c27b0', displayName: 'DOUBT' },
Â  Â  Â  Â  { name: 'clyde', index: 379, speed: 300, timer: 0, scared: false, start: 379, currentDir: 1, color: '#00bcd4', displayName: 'LONELINESS' }
Â  Â  ];
Â  Â Â 
Â  Â  function displayEnemiesOnTitle() {
Â  Â  Â  Â  const enemiesDisplay = document.getElementById('enemies-display');
Â  Â  Â  Â  if (!enemiesDisplay) return;
Â  Â  Â  Â  let html = '<div style="margin-bottom: 12px; letter-spacing: 2px; color: #ff007f;">THE GLOOMS:</div>';
Â  Â  Â  Â  ghosts.forEach(g => {
Â  Â  Â  Â  Â  Â  html += '<div style="margin: 5px 0; color: ' + g.color + '; text-shadow: 0 0 8px ' + g.color + ';">' + g.displayName + '</div>';
Â  Â  Â  Â  });
Â  Â  Â  Â  enemiesDisplay.innerHTML = html;
Â  Â  }

Â  Â  displayEnemiesOnTitle();
Â  Â Â 
Â  Â  function init() {
Â  Â  Â  Â  const containerW = document.getElementById('game-container').clientWidth;
Â  Â  Â  Â  const availableHeight = window.innerHeight * 0.8;
Â  Â  Â  Â  const availableWidth = window.innerWidth * 0.95;
Â  Â  Â  Â  let scale = Math.min(availableWidth / (width * TILE_SIZE), availableHeight / (width * TILE_SIZE));
Â  Â  Â  Â  canvas.width = width * TILE_SIZE * scale;
Â  Â  Â  Â  canvas.height = width * TILE_SIZE * scale;
Â  Â  Â  Â  ctx.scale(scale, scale);
Â  Â  Â  Â  drawBoard();
Â  Â  }

Â  Â  function getCoordinates(index) {
Â  Â  Â  Â  return { x: index % width, y: Math.floor(index / width) };
Â  Â  }

Â  Â  function getDistance(idx1, idx2) {
Â  Â  Â  Â  const c1 = getCoordinates(idx1);
Â  Â  Â  Â  const c2 = getCoordinates(idx2);
Â  Â  Â  Â  return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));
Â  Â  }

Â  Â  function gameLoop() {
Â  Â  Â  Â  if (!gameActive) return;

Â  Â  Â  Â  // --- PACMAN MOVEMENT ---
Â  Â  Â  Â  let nextMove = pacman.index + pacman.nextDir;
Â  Â  Â  Â  if(layout[nextMove] !== 1 && layout[nextMove] !== 2) {
Â  Â  Â  Â  Â  Â  pacman.dir = pacman.nextDir;
Â  Â  Â  Â  }
Â  Â  Â  Â  let moveIdx = pacman.index + pacman.dir;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (layout[moveIdx] !== 1 && layout[moveIdx] !== 2) {
Â  Â  Â  Â  Â  Â  pacman.index = moveIdx;
Â  Â  Â  Â  Â  Â  if(pacman.dir === 1) pacman.rot = 0;
Â  Â  Â  Â  Â  Â  if(pacman.dir === -1) pacman.rot = Math.PI;
Â  Â  Â  Â  Â  Â  if(pacman.dir === -width) pacman.rot = -Math.PI/2;
Â  Â  Â  Â  Â  Â  if(pacman.dir === width) pacman.rot = Math.PI/2;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Tunneling
Â  Â  Â  Â  if(pacman.index === 392) pacman.index = 419;
Â  Â  Â  Â  else if(pacman.index === 419) pacman.index = 392;

Â  Â  Â  Â  // Eating
Â  Â  Â  Â  if (layout[pacman.index] === 0 && !squares[pacman.index]) {
Â  Â  Â  Â  Â  Â  score++;
Â  Â  Â  Â  Â  Â  squares[pacman.index] = true;
Â  Â  Â  Â  Â  Â  scoreEl.innerText = score;
Â  Â  Â  Â  } else if (layout[pacman.index] === 3 && !squares[pacman.index]) {
Â  Â  Â  Â  Â  Â  score += 50;
Â  Â  Â  Â  Â  Â  squares[pacman.index] = true;
Â  Â  Â  Â  Â  Â  scoreEl.innerText = score;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Show hug quote
Â  Â  Â  Â  Â  Â  showHugQuote();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Scare ghosts
Â  Â  Â  Â  Â  Â  ghosts.forEach(g => g.scared = true);
Â  Â  Â  Â  Â  Â  setTimeout(() => ghosts.forEach(g => g.scared = false), 10000);
Â  Â  Â  Â  Â  Â  if(navigator.vibrate) navigator.vibrate(20);
Â  Â  Â  Â  }

Â  Â  Â  Â  if (score >= 274) { endGame(true); return; }

Â  Â  Â  Â  // --- GHOST AI (FIXED) ---
Â  Â  Â  Â  ghosts.forEach(ghost => {
Â  Â  Â  Â  Â  Â  ghost.timer++;
Â  Â  Â  Â  Â  Â  let moveThreshold = ghost.scared ? 12 : (ghost.name === 'blinky' ? 5 : 8);Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (ghost.timer > moveThreshold) {
Â  Â  Â  Â  Â  Â  Â  Â  ghost.timer = 0;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const possibleMoves = [-1, 1, -width, width];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Filter out walls (1) only - allow lair walls (2) and paths (0, 3, 4)
Â  Â  Â  Â  Â  Â  Â  Â  let validMoves = possibleMoves.filter(dir => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let next = ghost.index + dir;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(layout[next] === 1) return false; // Only block hard walls
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!ghost.scared && dir === -ghost.currentDir) return false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return true;
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  // If dead end, allow reverse
Â  Â  Â  Â  Â  Â  Â  Â  if(validMoves.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â validMoves = possibleMoves.filter(dir => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let next = ghost.index + dir;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return layout[next] !== 1; // Only block hard walls
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  if (validMoves.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let bestDir = validMoves[Math.floor(Math.random() * validMoves.length)];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!ghost.scared) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let target = pacman.index;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Pinky: 4 tiles ahead
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ghost.name === 'pinky') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  target = pacman.index + (pacman.dir * 4);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Blinky & Pinky: Target Closest Distance
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ghost.name === 'blinky' || ghost.name === 'pinky') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let minDst = Infinity;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  validMoves.forEach(dir => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let dst = getDistance(ghost.index + dir, target);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dst < minDst) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  minDst = dst;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bestDir = dir;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ghost.currentDir = bestDir;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ghost.index += bestDir;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Collision
Â  Â  Â  Â  Â  Â  Â  Â  if (ghost.index === pacman.index) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ghost.scared) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ghost.index = ghost.start;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  endGame(false);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  drawBoard();
Â  Â  Â  Â  setTimeout(() => requestAnimationFrame(gameLoop), 50);Â 
Â  Â  }

Â  Â  function drawBoard() {
Â  Â  Â  Â  ctx.fillStyle = '#000';
Â  Â  Â  Â  ctx.fillRect(0, 0, width*TILE_SIZE, width*TILE_SIZE);
Â  Â  Â  Â Â 
Â  Â  Â  Â  layout.forEach((cell, i) => {
Â  Â  Â  Â  Â  Â  let x = (i % width) * TILE_SIZE;
Â  Â  Â  Â  Â  Â  let y = Math.floor(i / width) * TILE_SIZE;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (cell === 1) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#1a1a3e';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeStyle = '#334155';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeRect(x,y,TILE_SIZE,TILE_SIZE);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeStyle = '#ff007f';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineWidth = 1;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeRect(x+5,y+5,TILE_SIZE-10,TILE_SIZE-10);
Â  Â  Â  Â  Â  Â  } else if (cell === 0 && !squares[i]) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#fbcfe8';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(x+10, y+10, 2, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  } else if (cell === 3 && !squares[i]) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#ff007f';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = '#ff007f';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 10;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(x+10, y+10, 5, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 0;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // Pacman
Â  Â  Â  Â  let px = (pacman.index % width) * TILE_SIZE + 10;
Â  Â  Â  Â  let py = Math.floor(pacman.index / width) * TILE_SIZE + 10;
Â  Â  Â  Â  ctx.save();
Â  Â  Â  Â  ctx.translate(px, py);
Â  Â  Â  Â  ctx.rotate(pacman.rot);
Â  Â  Â  Â  ctx.fillStyle = '#ff3366';
Â  Â  Â  Â  ctx.shadowBlur = 10;
Â  Â  Â  Â  ctx.shadowColor = '#ff3366';
Â  Â  Â  Â  ctx.font = "16px Arial";
Â  Â  Â  Â  ctx.textAlign = "center";
Â  Â  Â  Â  ctx.textBaseline = "middle";
Â  Â  Â  Â  ctx.fillText('â¤ï¸', 0, 2);
Â  Â  Â  Â  ctx.restore();

Â  Â  Â  Â  // Ghosts - Stress/Negative Emotions
Â  Â  Â  Â  ghosts.forEach(g => {
Â  Â  Â  Â  Â  Â  let gx = (g.index % width) * TILE_SIZE + 10;
Â  Â  Â  Â  Â  Â  let gy = Math.floor(g.index / width) * TILE_SIZE + 10;
Â  Â  Â  Â  Â  Â  ctx.fillStyle = g.scared ? '#38bdf8' : g.color;
Â  Â  Â  Â  Â  Â  ctx.shadowColor = ctx.fillStyle;
Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 10;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (g.name === 'blinky') {
Â  Â  Â  Â  Â  Â  Â  Â  // STRESS - Angry/Aggressive with sharp edges
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = g.scared ? '#38bdf8' : '#ff1744';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = ctx.fillStyle;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  // Jagged crown shape
Â  Â  Â  Â  Â  Â  Â  Â  ctx.moveTo(gx-7, gy+3);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx-5, gy-5);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx-2, gy+2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+2, gy-5);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+5, gy+2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+7, gy-4);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+7, gy+7);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx-7, gy+7);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  // Angry eyes
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx-3, gy+1, 1.5, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx+3, gy+1, 1.5, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  } else if (g.name === 'pinky') {
Â  Â  Â  Â  Â  Â  Â  Â  // ANXIETY - Wavy/Trembling shape
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = g.scared ? '#38bdf8' : '#ff6ec7';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = ctx.fillStyle;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  // Wavy edges
Â  Â  Â  Â  Â  Â  Â  Â  ctx.moveTo(gx-7, gy+4);
Â  Â  Â  Â  Â  Â  Â  Â  for (let i = -7; i <= 7; i += 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let wave = Math.sin(i * 0.5) * 2;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+i, gy-3+wave);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx+7, gy+7);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(gx-7, gy+7);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  // Worried eyes (wide)
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.ellipse(gx-3, gy+1, 2, 1.5, 0, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.ellipse(gx+3, gy+1, 2, 1.5, 0, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  } else if (g.name === 'inky') {
Â  Â  Â  Â  Â  Â  Â  Â  // DOUBT - Murky/Unclear shape
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = g.scared ? '#38bdf8' : '#9c27b0';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = ctx.fillStyle;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  // Blurry/uncertain edges
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx, gy, 7, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  // Confused eyes
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx-3, gy, 1.5, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx+3, gy, 1.5, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  // Question mark mouth
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeStyle = '#000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineWidth = 1;
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx, gy+4, 1, 0, Math.PI);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.stroke();
Â  Â  Â  Â  Â  Â  } else if (g.name === 'clyde') {
Â  Â  Â  Â  Â  Â  Â  Â  // LONELINESS - Fragmented/Broken shape
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = g.scared ? '#38bdf8' : '#00bcd4';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = ctx.fillStyle;
Â  Â  Â  Â  Â  Â  Â  Â  // Draw broken pieces
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx-3, gy-2, 3, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx+3, gy-2, 3, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx-2, gy+4, 3, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx+4, gy+4, 3, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  // Sad eyes
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = '#000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx-3, gy-2, 1, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.arc(gx+3, gy-2, 1, 0, Math.PI*2);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 0;
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function showHugQuote() {
Â  Â  Â  Â  const quote = hugQuotes[Math.floor(Math.random() * hugQuotes.length)];
Â  Â  Â  Â  const notification = document.createElement('div');
Â  Â  Â  Â  notification.style.cssText = `
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  background: rgba(255, 0, 127, 0.9);
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  padding: 20px 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-family: 'Fredoka One', sans-serif;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 30px rgba(255, 0, 127, 0.6);
Â  Â  Â  Â  Â  Â  border: 2px solid #ff007f;
Â  Â  Â  Â  Â  Â  max-width: 80%;
Â  Â  Â  Â  Â  Â  animation: quoteAppear 0.3s ease-out;
Â  Â  Â  Â  `;
Â  Â  Â  Â  notification.textContent = 'ğŸ’— ' + quote + ' ğŸ’—';
Â  Â  Â  Â  document.body.appendChild(notification);
Â  Â  Â  Â Â 
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  notification.style.animation = 'quoteDisappear 0.3s ease-out forwards';
Â  Â  Â  Â  Â  Â  setTimeout(() => notification.remove(), 300);
Â  Â  Â  Â  }, 2000);
Â  Â  }

Â  Â  function startRetrowaveMusic() {
Â  Â  Â  Â  if (musicStarted || !audioContext) return;
Â  Â  Â  Â  musicStarted = true;

Â  Â  Â  Â  // Create a simple retrowave synth melody
Â  Â  Â  Â  const now = audioContext.currentTime;
Â  Â  Â  Â  const tempo = 120;
Â  Â  Â  Â  const beatDuration = 60 / tempo;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Melody notes (frequencies in Hz)
Â  Â  Â  Â  const melody = [
Â  Â  Â  Â  Â  Â  { freq: 523.25, duration: 0.5 },Â  Â // C5
Â  Â  Â  Â  Â  Â  { freq: 659.25, duration: 0.5 },Â  Â // E5
Â  Â  Â  Â  Â  Â  { freq: 783.99, duration: 0.5 },Â  Â // G5
Â  Â  Â  Â  Â  Â  { freq: 659.25, duration: 0.5 },Â  Â // E5
Â  Â  Â  Â  Â  Â  { freq: 523.25, duration: 1 },Â  Â  Â // C5
Â  Â  Â  Â  Â  Â  { freq: 587.33, duration: 0.5 },Â  Â // D5
Â  Â  Â  Â  Â  Â  { freq: 659.25, duration: 0.5 },Â  Â // E5
Â  Â  Â  Â  Â  Â  { freq: 523.25, duration: 1 },Â  Â  Â // C5
Â  Â  Â  Â  ];

Â  Â  Â  Â  let time = now;
Â  Â  Â  Â  melody.forEach(note => {
Â  Â  Â  Â  Â  Â  const osc = audioContext.createOscillator();
Â  Â  Â  Â  Â  Â  const gain = audioContext.createGain();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  osc.type = 'square';
Â  Â  Â  Â  Â  Â  osc.frequency.value = note.freq;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  gain.gain.setValueAtTime(0.1, time);
Â  Â  Â  Â  Â  Â  gain.gain.exponentialRampToValueAtTime(0.01, time + note.duration * beatDuration);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  osc.connect(gain);
Â  Â  Â  Â  Â  Â  gain.connect(audioContext.destination);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  osc.start(time);
Â  Â  Â  Â  Â  Â  osc.stop(time + note.duration * beatDuration);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  oscillators.push(osc);
Â  Â  Â  Â  Â  Â  time += note.duration * beatDuration;
Â  Â  Â  Â  });

Â  Â  Â  Â  // Loop the melody
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  if (gameActive && musicStarted) {
Â  Â  Â  Â  Â  Â  Â  Â  startRetrowaveMusic();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, time * 1000 - now * 1000);
Â  Â  }

Â  Â  function endGame(win) {
Â  Â  Â  Â  gameActive = false;
Â  Â  Â  Â  if(win) {
Â  Â  Â  Â  Â  Â  finaleScreen.classList.add('active');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('final-heart').style.opacity = '1';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('final-partner').style.opacity = '0.4';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('final-hug').style.opacity = '1';
Â  Â  Â  Â  Â  Â  Â  Â  if(navigator.vibrate) navigator.vibrate([100,50,100]);
Â  Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  document.body.style.backgroundColor = '#330000';
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Caught! Try again.");
Â  Â  Â  Â  Â  Â  Â  Â  location.reload();
Â  Â  Â  Â  Â  Â  }, 100);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // Input handling
Â  Â  document.addEventListener('keydown', e => {
Â  Â  Â  Â  if(e.key === 'ArrowLeft' || e.key === 'a') pacman.nextDir = -1;
Â  Â  Â  Â  if(e.key === 'ArrowRight' || e.key === 'd') pacman.nextDir = 1;
Â  Â  Â  Â  if(e.key === 'ArrowUp' || e.key === 'w') pacman.nextDir = -width;
Â  Â  Â  Â  if(e.key === 'ArrowDown' || e.key === 's') pacman.nextDir = width;
Â  Â  });

Â  Â  let tsX, tsY;
Â  Â  document.addEventListener('touchstart', e => {
Â  Â  Â  Â  tsX = e.touches[0].clientX;
Â  Â  Â  Â  tsY = e.touches[0].clientY;
Â  Â  }, {passive: false});
Â  Â Â 
Â  Â  document.addEventListener('touchend', e => {
Â  Â  Â  Â  let dx = e.changedTouches[0].clientX - tsX;
Â  Â  Â  Â  let dy = e.changedTouches[0].clientY - tsY;
Â  Â  Â  Â  if (Math.abs(dx) > 10 || Math.abs(dy) > 10) {
Â  Â  Â  Â  Â  Â  if(Math.abs(dx) > Math.abs(dy)) {
Â  Â  Â  Â  Â  Â  Â  Â  pacman.nextDir = dx > 0 ? 1 : -1;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  pacman.nextDir = dy > 0 ? width : -width;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }, {passive: false});

Â  Â  // Start button
Â  Â  document.getElementById('start-btn').addEventListener('click', () => {
Â  Â  Â  Â  startScreen.classList.add('hidden');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Initialize audio context
Â  Â  Â  Â  if (!audioContext) {
Â  Â  Â  Â  Â  Â  audioContext = new (window.AudioContext || window.webkitAudioContext)();
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  init();
Â  Â  Â  Â  gameActive = true;
Â  Â  Â  Â  startRetrowaveMusic();
Â  Â  Â  Â  gameLoop();
Â  Â  });

Â  Â  window.addEventListener('resize', () => {
Â  Â  Â  Â  if(gameActive) init();
Â  Â  });

Â  Â  // Add quote animation styles
Â  Â  const style = document.createElement('style');
Â  Â  style.textContent = `
Â  Â  Â  Â  @keyframes quoteAppear {
Â  Â  Â  Â  Â  Â  from {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(0.8);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  to {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(1);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes quoteDisappear {
Â  Â  Â  Â  Â  Â  from {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(1);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  to {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(0.8);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  `;
Â  Â  document.head.appendChild(style);
</script>

</body>
</html>
